---
import Thoughts from "@components/Thoughts.astro";
import Page from "@layouts/Page.astro";
import Post from "@layouts/Post.astro";
import { getCollection } from "astro:content";

// Generate a new path for every collection entry
export const getStaticPaths = async () =>
  (await getCollection("thoughts", ({ data: { draft } }) => !draft)).map(
    (entry) => ({
      params: { id: entry.id },
      props: { entry },
    })
  );

const { entry } = Astro.props;
---

<Page
  title={entry.data.title}
  description={`${entry.body!.split(/[.?!](?=\s+)/, 1)[0]!.trimStart()}.`}
  ><Post entry={entry} followedByOther /><div class="-mt-24 lg:-mt-20">
    <Thoughts isNotFullpage exclude={[entry]} />
  </div></Page
>
