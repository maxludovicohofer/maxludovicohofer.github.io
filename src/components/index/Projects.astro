---
import Card from "@layouts/Card.astro";
import PostPreview from "@layouts/PostPreview.astro";
import type { ComponentProps } from "astro/types";
import { getCollection } from "astro:content";

interface Props {
  importance?: ComponentProps<typeof PostPreview>["importance"];
}

const { importance } = Astro.props;

// TODO SORT BY LATEST FIRST (EXCLUDING HIGHLIGHT AND LATEST), THEN ADD HIGHLIGHT AND LATEST AT THE END
const projects = await getCollection(
  "projects",
  ({ data: { draft } }) => !draft
);

// TODO READ MORE TEXT SHOULD BE "ALL PROJECTS"
// TODO SINGLE PROJECTS SHOULD BE READ MORE ON CLICK, AND NOT WITH BUTTON AT THE END. ALSO SHOULD HAVE SET HEIGHT ALWAYS.
// TODO ALSO, MAKE PROJECTS PAGE
---

<PostPreview importance={importance} readMore="projects" container>
  <ol
    class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-1 gap-4"
  >
    {
      projects.map(async (project) => {
        return (
          <Card tag="li">
            <PostPreview content={project} />
          </Card>
        );
      })
    }
  </ol>
</PostPreview>
